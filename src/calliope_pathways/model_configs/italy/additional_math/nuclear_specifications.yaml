constraints:
  annual_capacity_factor_min:
    description: >
      Limit the lower bound of annual nuclear operation as a
      fraction of annual operation at maximum capacity.
    foreach: [nodes, techs, carriers, investsteps]
    where: capacity_factor_min
    equations:
      - expression: >
          sum(flow_out * timestep_weights, over=timesteps) >=
          flow_cap * capacity_factor_min * $total_time
    sub_expressions:
      total_time: &total_time
        - expression: sum(timestep_resolution * timestep_weights, over=timesteps)

  annual_capacity_factor_max:
    description: >
      Limit the upper bound of annual nuclear operation as a
      fraction of annual operation at maximum capacity.
    foreach: [nodes, techs, carriers, investsteps]
    where: capacity_factor_max
    equations:
      - expression: >
          sum(flow_out * timestep_weights, over=timesteps) <=
          flow_cap * capacity_factor_max * $total_time
    sub_expressions:
      total_time: *total_time